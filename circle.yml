machine:
  python:
    version: 3.5.0
  node:
    version: 6.9.2

checkout:
  post:
    - scripts/notify/start-test.sh

dependencies:
  cache_directories:
    - node_modules
  override:
    - npm i -g yarn
    - yarn

test:
  override:
    - yarn test
    - yarn run build
    - [ $CIRCLE_BRANCH = 'master' ] && scripts/test/git-status.sh
  post:
    - scripts/notify/end-test.sh

deployment:
  production:
    branch: master
    commands:
      - scripts/deploy.sh
